clear all
clc
x_train=[4730	1202	300	937.56	20016.8	1206	139.1500849
4706	1203	300	904.656	20175.6	1783	64.04099573
4606	1670	260	1359.297	23743.4	1624	49.27907857
4946	1604	400	1373.9864	24967.2	1607	67.67379222
4987	1574	400	1471.9455	26470.9	1815	36.82632757
5046	1604	300	1449.0536	24688.6	1541.5	77.58236595
5174	2022	200	1650.632	29939.1	1900	62.69393536
5532	2011	500	1745.548	36312.4	2160	68.05664181
4708	1400	200	1136.8	22105.9	1370	130.7990267
5356	1965	200	1684.8015	38004.5	2270	154.1317476
5526	2012	500	1603.9664	33125.8	2250	100.3900283
5102	1803	500	1103.258266	24002.7	1240	76.54232602
5315	1652	300	1590.6135	30016	1850	65.61393416
4325	1243	200	1082.7	21644.5	1285	143.5422394
5140	1804	500	1387.1	25686.7	1410	21.36700397
5520	1760	300	1449.69616	29952.43	1580	113.48328
5352	1605	500	1349.805	30356.4	1750	100.3610441
4944	1608	300	1522.00215	36650.4	1800	29.2171362
5306	2003	500	1630.387125	23617.5	1438.4	46.44734068
4890	2000	260	1961.25	36941.9	2125	83.07745911
4625	1802	200	1636.12	32045.4	1960	64.54774219
4678	1802	200	1746.38	32031.9	1840	65.72404741
4740	1803	200	1661.6	32705.4	1870	65.71913502
4941	1604	200	1554.76	30092.5	1715	36.76069397
4994	1600	200	1470.63	27948.6	1731	33.04037868
4950	1604	200	1502	31351.6	1776	31.78250534
4905	1600	200	1466.25	32317.2	1835	19.78741106
5034	1802	150	1754	51167.3	3275	24.76217839
4998	1800	150	1762.7	39623.9	2196	49.92256699
5040	1763	100	1757.1	27289.2	1889	12.89182669
4597	1489	100	1352.13	24194.6	1770	19.91706773
4800	1600	100	1541.4	30705.1	2510	21.20677012
4860	1622	100	1519.25	33339.7	2653	17.29274338
5300	1970	300	1591.1	20123.7	1738	59.69043727
5015	1601	300	1405.25	25580.9	1635	130.5419599
4830	1400	300	1379.25	28097.3	1695	90.63084388
4858	1400	300	1320.5	24353.8	1525	77.94506207
4816	1400	300	1277.5	24920.1	1555	75.29428856
4820	1996	400	1324.25	26639	1543	61.30508795
5014	1572	300	1374.375	28332.7	1487	69.02435462
5355	2000	400	1909.63	34089.31	1700	61.70371424
5290	3088	300	1532	25964.7	1563	80.79816058
4778	3829	300	1372.63	30456.6	1501	52.79315485
5190	1704	300	1605.38	33425.12	1912	47.37620792
5167	1670	350	1515.25	26848.1	1550	64.6802626
4751	1300	350	1089.63	26445.6	1385	42.34030871
5089	1583	350	1501.25	25246.2	1665	109.493706
5118	1678	350	1526	29598.3	1695	108.6717818
5255	1601	351	1432.25	26954.9	1700	78.61052111
4848	1400	352	1154	25687.4	1480	23.61232371
5256	1799	353	1455	29519.5	1770	61.45869918
3754	1357	300	1088.25	21690.9	1250	75.60501186
2650	1747	150	1668.5	37202.9	2125	21.20825912
3643	1707	300	1485.88	24548.7	1390	83.52829803
4980	1495	300	1362.63	25089.44	1652	84.31888565
4989	1802	150	1791.5	59258.9	3330	26.08280141
3390	1750	350	1561.5	34522.5	1686	27.03459133
4566	1186	300	1122.5	19446	1250	69.21754532
4493	3388	300	965	16525.3	961	68.72761127
4938	1780	100	1737.38	24551.8	1677	30.16790944
4544	1172	300	1032.1	8347.086667	633	37.89239296
5020	1802	100	1781.75	29173.6	1900	27.82442827
4632	1060	100	910	18782.52	1041	100.8831843
5023	1801	150	1706.63	55249.1	3204	47.58497773
5146	1779	300	1779	62154	5807	34.69768639
4804	1606	100	1417.5	24220.6	1670	21.41284771
4958	1603	300	1164.37	19948.4	1285	161.7542901
5240	1834	300	1809.25	27800	1855	65.96745027
4423	1045	300	821.75	16637.8	882	103.2836037
5284	1890	300	1857.4	18597.5	955	73.00627694
5239	1851	300	1699.875	29441.9	2840	24.63901263
5246	1848	200	1783.5	29190.6	2945	24.43695885
5258	3223	300	1750	47111.67	4680	40.47404815
5318	2014	300	1938.5	34629.2	2190	51.90472316
5405	2004	300	1883.875	53118.5	2052	32.37524612
4745	1171	301	894.875	20874.5	1850	37.31710877
4710	1200	302	1031	16332.8	1420	22.81688005
4511	1005	303	902.375	9075	1100	13.09641873
5363	1005	304	960.8242	24145.8	1201	121.8392809
5462	1932	200	1692.125	30274.5	2285	18.12029384
5455	1893	200	1555.625	29122.7	2290	20.3769191
4514	1600	200	1547	57974.5	2400	60.93044426
4497	1591	200	1512.125	56123.5	2460	71.75859031
4603	1653	200	1583.625	61062.3	2420	54.80219074
4764	1768	200	1682.625	65195.1	2695	46.77619755
4639	1600	200	1415.875	22954.5	2210	57.91819956
4545	1645	200	1349.125	23309.1	2034	50.08619397
4554	1622	200	1426.625	24700.3	2390	92.17605234
4510	1486	200	1472	20961.5	2070	54.54108502
4696	1580	200	1459	20231.8	2120	51.05769861
4578	1634	200	1214.625	18522.9	1910	55.59347873
4474	1600	200	1271.625	14538.1	1545	90.90964339
4552	1574	200	1308.5	18439	1980	66.51090641
4520	1624	200	1362.75	15373	1479	50.18959343
4810	1900	200	1566.5	69517	2320	41.86899446
4844	2000	200	1409.375	22439.9	1840	50.10362982
4850	1940	200	1651.125	22857.8	1745	45.86498383
4586	1800	200	1661.5	22223.4	2100	35.3806464
4548	1600	200	1450.5	58435.2	2490	28.40221839
4482	1602	200	1473.875	59599.3	2445	33.89740993
4581	1800	200	1634.12	62844.4	2700	27.97155069
4694	1694	200	1627.625	65511.3	2585	30.10654857
4403	1508	200	1397.375	65094.4	2400	27.07191877
4554	1610	200	1425.25	20099	2030	36.43914442
4494	1600	200	1258.5	20937.1	2220	50.5607136
4526	1600	200	1257.125	18580	1820	60.25323686
4400	1500	200	949.125	18161.7	1745	47.8162871
4557	1621	200	1371.125	20818.1	1818	41.73799832
5151	1601	250	1433.12	25306.1	2405	50.32332596
4779	1800	250	995.5	16114.8	1670	60.3231041
5358	1940	200	1892	33267.2	3165	23.55798972
5288	1730	200	1728.5	31577	3133	30.04546073
5363	1800	200	1633.62	66280.5	2950	27.77232136
5334	1800	200	1819.625	28161.8	3047	27.41547027
4933	1445	200	1167	45820.7	1830	48.38850132
5372	1800	200	1760	27912.4	2690	24.37055096
5446	1550	200	1425	30760.9	2148	27.22317826
5459	1800	200	1821	33753	2512	22.60526757
5446	1800	200	1755	31341.5	2733	36.60992129
5340	1411	200	918	28823	2405	32.45550531
5063	1800	200	1371	23209.8	2225	44.13413817
5324	1800	200	1871	28420	2650	33.57664234
5354	1500	200	1366	27994.8	2650	26.65472509
5416	1830	200	1826	30921	2750	26.37321857
5380	1800	200	1742	27070.2	2505	36.55881129
5391	1792	200	1594	14812.4	2141	66.80783851

    ];
y_train=[3.230888784
2.803362121
2.274994553
4.443930707
3.923674021
2.707875715
4.423459881
2.825485535
1.8930557
1.874564076
2.034216653
4.219065697
3.017480324
2.026474541
0.541167466
2.836672648
5.654271985
2.280049442
3.479322654
2.721871707
2.235116689
2.809409718
3.174730457
3.785192171
2.950246335
2.744753213
2.405329613
3.150189812
3.300158206
2.111324839
2.081154256
2.222721314
2.166425881
2.387436602
2.921765251
1.568915288
2.140502963
1.851956235
1.803168534
2.759800451
2.984482114
3.253547841
3.959725733
2.651146891
2.979632688
0.4474
1.768658111
3.056160847
1.376890131
2.981479341
2.659069273
1.953997202
1.784820626
4.240550807
4.84572804
2.631688243
0.518
3.016738548
1.85288037
2.250292103
2.091896285
2.222011976
2.615670623
2.574120056
2.512045007
2.157074327
2.975465316
3.316919312
1.903970244
4.752089199
3.545062058
3.388265306
3.263061537
3.579762389
3.766382447
4.068790373
2.970404353
1.953269239
2.852006307
3.190601192
2.062647854
2.428157007
2.206861857
2.674593553
2.361646559
2.981400929
0.487802437
2.345313789
0.454840321
0.35552983
2.271949807
2.743224677
3.300035828
0.645900923
2.466312231
1.672031764
1.67611967
2.107066796
2.073442608
2.1814531
2.322349895
2.688583193
2.596839975
2.659914185
2.754459181
2.102956524
0.828296029
3.485962014
2.369766325
2.257975729
2.185832512
2.772191995
3.425929156
3.73803302
1.397136526
0.974834177
1.35198646
1.027763567
1.560062624
2.772112671
1.46957801
2.213222195
2.583902003
1.89692518
2.713888439
3.5273051

    ];
%x_test=[0.04, 0.002,   x(1),  x(2)];
% scale = [10, 1000, 1, 0.001, 0.0001, 0.1];
% for idx=1:length(scale)
%     x_train(:, idx) = x_train(:, idx) * scale(idx);
%      x_test(:, idx) = x_test(:, idx) * scale(idx);
% end
%  x_test=zscore(x_test);
%  x_train=zscore(x_train);
% factor = 0.1;
% regua=[0.000780967823085971];
% kparams0=[8.87046300623582,1.68959160641905,4.95873670316361,8.75443395666459,5.79311884023257,10.2760630968636,7.44394730711642];
% sigmaN0=[1.14002451990162];
%kernel = [{'exponential'},{'squaredexponential'},{'matern32'},{'matern52'},{'rationalquadratic'},{'ardexponential'},{'ardsquaredexponential'},{'ardmatern32'},{'ardmatern52'},{'ardrationalquadratic'}];
gprMdl_idx = fitrgp(x_train, y_train,'KernelFunction','rationalquadratic' ,'FitMethod','sr','PredictMethod','fic', 'Standardize',1,'regularization', 0.1);
cvgprMdl_idx = crossval(gprMdl_idx,'KFold',10);
 L1 = kfoldLoss(cvgprMdl_idx,'mode','individual');
 L2 = kfoldLoss(cvgprMdl_idx);
 mse = mean(L1);
 ypred_idx(:,1) = kfoldPredict(cvgprMdl_idx);
 output_train = ypred_idx(:,1);
 RMSE = sqrt(mean((y_train-output_train).^2))
 

 
 
 
 
 
 
 


