
clc;
clear all;
x_train=[90	200
100	200
200	200
400	200
600	200
75	300
90	300
100	300
200	300
400	300
600	300
75	400
90	400
100	400
200	400
400	400
600	400
60	500
75	500
100	500
200	500
400	500
600	500
75	600
90	600
100	600
200	600
400	600
600	600
75	700
90	700
100	700
200	700
400	700
600	700
60	800
75	800
90	800
100	800
200	800
400	800
600	800
75	900
90	900
100	900
200	900
400	900
600	900
60	1000
100	1000
200	1000
400	1000
600	1000
45	1200
60	1200
100	1200
200	1200
400	1200
600	1200
45	1400
60	1400
100	1400
200	1400
400	1400
600	1400
45	1600
60	1600
100	1600
200	1600
400	1600
600	1600
45	1800
60	1800
100	1800
200	1800
400	1800
600	1800
45	2000
60	2000
100	2000
200	2000
400	2000
600	2000
45	2200
60	2200
100	2200
200	2200
400	2200
600	2200
45	2400
60	2400
100	2400
200	2400
400	2400
600	2400
45	2600
60	2600
100	2600
200	2600
400	2600
600	2600
45	2800
60	2800
100	2800
200	2800
400	2800
600	2800
60	3000
100	3000
200	3000
300	3000
400	3000
500	3000
600	3000
45	3200
60	3200
100	3200
200	3200
400	3200
600	3200
45	3400
60	3400
100	3400
200	3400
400	3400
600	3400
45	3600
60	3600
100	3600
200	3600
400	3600
600	3600
45	3800
60	3800
100	3800
200	3800
400	3800
600	3800
60	4000
200	4000
300	4000
400	4000
500	4000
600	4000
45	4200
60	4200
100	4200
200	4200
400	4200
600	4200
45	4400
60	4400
100	4400
200	4400
400	4400
600	4400
45	4600
60	4600
100	4600
200	4600
400	4600
600	4600
45	4800
60	4800
100	4800
200	4800
400	4800
600	4800
45	5000
60	5000
100	5000
200	5000
300	5000
400	5000
500	5000
600	5000
45	5200
60	5200
100	5200
300	5200
600	5200
45	5400
60	5400
100	5400
300	5400
600	5400
45	5600
60	5600
100	5600
300	5600
600	5600
45	5800
60	5800
100	5800
300	5800
600	5800
45	6000
60	6000
100	6000
200	6000
400	6000
600	6000
45	6200
60	6200
100	6200
300	6200
600	6200
45	6400
60	6400
100	6400
300	6400
600	6400
45	6600
60	6600
100	6600
300	6600
600	6600
45	6800
60	6800
100	6800
300	6800
600	6800
45	7000
60	7000
100	7000
200	7000
400	7000
600	7000
45	7200
60	7200
100	7200
300	7200
600	7200
45	7400
60	7400
100	7400
300	7400
600	7400
45	7600
60	7600
100	7600
300	7600
600	7600
45	7800
60	7800
100	7800
300	7800
600	7800
45	8000
60	8000
100	8000
200	8000
400	8000
600	8000
45	8200
60	8200
100	8200
300	8200
600	8200
45	8400
60	8400
100	8400
300	8400
600	8400
45	8600
60	8600
100	8600
300	8600
600	8600
45	8800
60	8800
100	8800
300	8800
600	8800
45	9000
60	9000
100	9000
200	9000
400	9000
600	9000
45	9200
60	9200
100	9200
300	9200
600	9200
45	9400
60	9400
100	9400
300	9400
600	9400
45	9600
60	9600
100	9600
300	9600
600	9600
45	9800
60	9800
100	9800
300	9800
600	9800
45	10000
60	10000
100	10000
200	10000
400	10000
600	10000

];
y_train=[3.568
3.186
7.859
18.33
31.81
3.839
4.445
4.186
10.34
24.65
41.59
4.443
4.57
5.181
12.35
29.13
50.71
3.641
4.389
6.055
14.49
33.72
56.29
4.948
5.741
6.602
15.86
36.36
61.65
5.564
6.582
7.577
17.5
39.64
66.84
5.031
6.002
7.233
8.169
19.56
44.08
71.85
6.317
7.73
8.581
20.35
46.84
74.96
4.862
8.713
19.85
45.54
73.17
3.409
5.259
9.638
22.69
51.07
82.17
4.396
5.951
11
25.85
56.04
89.87
4.539
6.428
12.54
28.15
60.5
96.22
4.579
6.79
13.52
30.51
64.9
102.9
4.657
7.011
14.23
32.61
69.16
111.2
4.872
7.141
15.06
34.21
72.45
116.7
4.627
7.477
16.79
36.33
76.45
121.8
4.651
7.471
17.12
39.7
79.72
126.8
4.586
7.407
16.47
41.62
83.46
131.4
7.488
16.03
43.15
65.38
86.62
110.4
136.8
4.565
7.813
16.51
44.53
90.23
141.3
4.519
7.45
16.44
45.29
92.5
145.4
4.77
7.953
17.28
46.2
95.08
150.2
4.793
7.64
17.03
49.4
97.52
153.6
7.499
50.7
77.18
102.1
128.2
158.2
5.073
7.988
15.41
51.23
104.3
162.1
5.022
7.947
15.41
51.97
106.9
163.6
4.975
8.397
15.73
52.44
107.8
165.4
5.082
8.265
15.73
53.22
110.1
172.1
1.79475
8.151
15.61
55.78
84.34
111.6
143.8
175.2
5.097
8.013
15.55
85.66
179.5
4.994
7.843
15.43
87.12
180.6
5.227
7.804
15.17
88.49
183
5.192
7.753
15.16
93.63
185.3
5.214
7.762
15.25
59.66
123.4
184.8
5.343
7.676
15.33
95.28
191.1
5.754
7.794
15.28
96.26
192.3
5.665
7.757
15.58
96.35
192.7
5.731
7.643
15.14
95.73
198.6
5.701
7.792
16.06
61.93
127.8
201.9
6.22
7.599
15.74
99.58
201.1
6.378
7.701
15.87
98.2
204
6.224
7.698
15.82
103
203.5
6.633
7.588
15.75
100.9
214.6
6.405
7.803
16.02
67.28
137
204.1
6.475
7.951
16.69
110.8
203.9
6.434
7.849
16.24
109.5
213.8
6.238
8.139
16.58
111
220
6.399
8.242
16.44
115.6
222
6.377
8.129
16.66
67.46
143.6
217
5.997
8.008
17.04
113.7
220.1
5.944
8.042
16.63
115.2
224.2
6.107
8.06
16.53
114.8
226.9
6.185
7.874
16.76
116.3
222.8
6.05
7.88
16.96
73.19
153.5
225.3

    
];


x_test=[200 9600
];
% scale = [10, 1000, 1, 0.001, 0.0001, 0.1];
% for idx=1:length(scale)
%     x_train(:, idx) = x_train(:, idx) * scale(idx);
%      x_test(:, idx) = x_test(:, idx) * scale(idx);
% end
%  x_test=zscore(x_test);
%  x_train=zscore(x_train);
% factor = 0.1;
% regua=[0.000780967823085971];
% kparams0=[8.87046300623582,1.68959160641905,4.95873670316361,8.75443395666459,5.79311884023257,10.2760630968636,7.44394730711642];
% sigmaN0=[1.14002451990162];

%kernel = [{'exponential'},{'squaredexponential'},{'matern32'},{'matern52'},{'rationalquadratic'},{'ardexponential'},{'ardsquaredexponential'},{'ardmatern32'},{'ardmatern52'},{'ardrationalquadratic'}];

gprMdl_idx = fitrgp(x_train, y_train,'KernelFunction','ardsquaredexponential' ,'FitMethod','sr','PredictMethod','fic', 'Standardize',1);
% cvgprMdl_idx = crossval(gprMdl_idx,'KFold',10);
%  L1 = kfoldLoss(cvgprMdl_idx,'mode','individual');
%  L2 = kfoldLoss(cvgprMdl_idx);
%  mse = mean(L1)


%≤‚ ‘ ˝æ›‘§≤‚
output_train = predict(gprMdl_idx,x_test)
% ypred_jdx = predict(gprMdl_jdx,x_test);
% output_train = (ypred_idx * factor + ypred_jdx * (1-factor))




